<html>

<head>
    <script type="text/javascript" src="https://unpkg.com/xlsx@0.15.1/dist/xlsx.full.min.js"></script>
</head>

<body>
    <table border="1">
        <tbody>
            <table id="tbl_exporttable_to_xls1" border="1">
                <thead>
                    <th>No</th>
                    <th>Name</th>
                    <th>Location</th>
                    <th>Job Profile</th>
                </thead>
                <tr>
                    <td>1</td>
                    <td>
                        <p>Vikas</p>
                    </td>
                    <td>Mysore</td>
                    <td>Software Analyst</td>
                    <td>
                        <button onclick="exportTableToExcel('tbl_exporttable_to_xls1', 'vikas')">
              Export table to excel
            </button>
                    </td>
                </tr>
            </table>
            <table id="tbl_exporttable_to_xls2" border="1">
                <thead>
                    <th>No</th>
                    <th>Name</th>
                    <th>Location</th>
                    <th>Job Profile</th>
                </thead>
                <tr>
                    <td>2</td>
                    <td>
                        <p>Vinod</p>
                    </td>
                    <td>Bangalore</td>
                    <td>Software Analyst</td>
                    <td>
                        <button onclick="exportTableToExcel('tbl_exporttable_to_xls2', 'vinod')">
              Export table to excel
            </button>
                    </td>
                </tr>
            </table>
            <table id="tbl_exporttable_to_xls3" border="1">
                <thead>
                    <th>No</th>
                    <th>Name</th>
                    <th>Location</th>
                    <th>Job Profile</th>
                </thead>
                <tr>
                    <td>3</td>
                    <td>
                        <p>Pandurang Jadav</p>
                    </td>
                    <td>Bangalore</td>
                    <td>Associate Developer</td>
                    <td>
                        <button onclick="exportTableToExcel('tbl_exporttable_to_xls3', 'pandu')">
              Export table to excel
            </button>
                    </td>
                </tr>
            </table>
            <table id="tbl_exporttable_to_xls4" border="1">
                <thead>
                    <th>No</th>
                    <th>Name</th>
                    <th>Location</th>
                    <th>Job Profile</th>
                </thead>
                <tr>
                    <td>4</td>
                    <td>
                        <p>Rishabh</p>
                    </td>
                    <td>Uttar Pradesh</td>
                    <td>Java Developer</td>
                    <td>
                        <button onclick="exportTableToExcel($(this), 'rishabh')">
              Export table to excel
            </button>
                    </td>
                </tr>
            </table>
            <table id="tbl_exporttable_to_xls5" border="1">
                <thead>
                    <th>No</th>
                    <th>Name</th>
                    <th>Location</th>
                    <th>Job Profile</th>
                </thead>
                <tr>
                    <td>5</td>
                    <td>
                        <p>Chandra</p>
                    </td>
                    <td>Bangalore</td>
                    <td>Manager</td>
                    <td></td>
                </tr>
                <button onclick="exportTableToExcel('tbl_exporttable_to_xls5', 'chandra')">
          Export table to excel
        </button>
            </table>
        </tbody>
    </table>

    <!-- <script>
      function exportTableToExcel(tableId, filename) {
        var wb = XLSX.utils.table_to_book(tableId, { sheet: "sheet1" });
        return dl
          ? XLSX.write(wb, { bookType: type, bookSST: true, type: "base64" })
          : XLSX.writeFile(wb, filename + "." + (type || "xlsx"));
      }
    </script> -->

    <script>
        function exportTableToExcel(tableID, filename) {
            var downloadLink;
            var dataType = "application/vnd.ms-excel";
            var tableSelect = document.getElementById(tableID);
            var tableHTML = tableSelect.outerHTML.replace(/ /g, "%20");
            // Specify file name
            filename = filename ? filename + ".xls" : "excel_data.xls";

            // Create download link element
            downloadLink = document.createElement("a");

            document.body.appendChild(downloadLink);

            // if (navigator.msSaveOrOpenBlob) {
            //   var blob = new Blob(["\ufeff", tableHTML], {
            //     type: dataType,
            //   });
            //   navigator.msSaveOrOpenBlob(blob, filename);
            // } else {
            // Create a link to the file
            downloadLink.href = "data:" + dataType + ", " + tableHTML;

            // Setting the file name
            downloadLink.download = filename;

            //triggering the function
            downloadLink.click();
        }
        // }
    </script>
</body>

</html>